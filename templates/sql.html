<!DOCTYPE html>
<html>
<head>
    <title>SQL Query</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        function clearError() {
            var alertDiv = document.querySelector('.alert-danger');
            if (alertDiv) {
                alertDiv.remove();
            }
        }
    </script>
</head>
<body>
    {% include 'header.html' %}
    <div class="row">
        <div class="col-md-12">
                <br>
                Write a standard SQL query and the resultset will be returned as a file (currently HTML & CSV only).<br><br>
                The tables that you can select from are:-<br><br>
                <li><b>stock_price_history</b> - provides daily prices for FTSE100, DAX and the magnificent 7 companies. The stock_symbol follows yahoo finance ticker format</li><br>
                <li><b>market_stocks</b> - provides the market (FTSE 100 | DAX | S&P 500), the stock_name and it's stock_symbol</li>
                {% if error %}
                <div class="alert alert-danger" role="alert">
                    {{ error }}
                </div>
                {% endif %}
                <br>
        </div>
        <div class="col-md-12">
            <form action="{{ url_for('query') }}" method="POST" onsubmit="clearError()">
                <label for="sql">Enter your SQL query:</label><br>
                <textarea id="sql" name="sql" rows="10" cols="50">{{ sql|default('') }}</textarea><br>
                <label for="export">Export format:</label>
                <select id="export" name="export">
                    <option value="html" selected>HTML</option>
                    <option value="csv">CSV</option>
                </select>
                <input type="submit" value="Submit">
            </form>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
